08.16.2024 Owen debugging
Error:  Exception: normal_lpdf: Location parameter is inf, but must be finite! (in 'string', line 190, column 8 to column 73)
Note: this is in the part of the model that samples the y[i] as a normal(Ct,sigma)
Specifically, it had an issue with the sigma (i.e. location) param
Investigating this further in the transformed params block, sigma is a function of the gamma params and the Concentration vector
Gamma params have priors and so they shouldn't be the issue; once again the issue is in "filling" the Concentration vector
Putting a print statement for the Concentration vector,we get -inf values in some of the STANDARDS, NOT the unknowns
Identified the problem: there was a double log going on; i.e., the copy numbers in the standards were being logged before they
went into the model, and then AGAIN in the transformed data block. Because some of the original copy numbers were 1, this messed 
everything up (because log(1)=0 and log(0)= -Inf)


08.19.2024 Checking divergences
Model is sampling, but almost all divergent transitions--why??
Ole and Owen went through using print statements etc.
Added a few initial values to help (for beta_std_curve_0 and beta_std_curve_1)
Still having an issue: Ct values are not changing across samples-- why??
Ole and Owen going to dig into indexing issues

09.13.2024 New updates
Major updates to the model, converging now
Now, trying to optimize the sampling
Tried centering log_D_raw and tightening the prior
Removing the hard lower bound on beta_std_curve_1.
Adding eta_mock back into the metabarcoding
Check paired bio replicates
Added eta_mock back in, and made it N(0,tau) with tau ~ gamma(100,1000)

09.19.2024 New updates
Have added some output plotting and spatial smoothing, but still issues with eta and alphas (variability in the mocks)
Trying to swap to the Dirichlet multinomial to account for overdispersion, and removing eta for now
To do this, edited the code in qm_qpcr_joint-DM. Now there are two versions of the Stan model (Dirichlet vs. multinomial)
Removed model_matrix_samp and other declared data and params that weren't being used anymore in our parameterization

09.20.2024 Science Friday
Discussed Dirichlet multinomial as a group, and agreed to move forward with it for now
dm_alpha_0 should be bigger. give it a less informative/bigger prior
Tried modeling ONLY the mocks with the Dirichlet multinomial; field samples have the regular multinomial

...tried adding different alpha_0 for samples and mocks. Didn't really work


09.23.24
Tried a version with D-M for both mocks and field samples. dm_alpha0_mock fixed at 100 for the mocks
This converged with dm_alpha0_samp ~1.75, alpha (for QM) smaller than before -0.06-0.04

Tried again with a fixed dm_alpha0_mock, but a regular multinomial for the field samples
The field samples fit well, but large alphas and bad fitting mocks still; lots of divergences

Tried again with just a large prior on dm_alpha0_mock (N(100,10))
...dm_alpha0_mock still ends up at ~3, and mock fits do not look good

TODO:
Check the few outliers in the qPCR
Check stepsize after the warmup is complete
Compare qPCR samples that match MB vs. non-matched samples and compare overdispersion
Add depth plots to diagnostics
Check indexing again for MB samples
Try not reporting some transformated params

